[2023-12-26T04:35:26.762+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: potential_customers_process.extract_customer manual__2023-12-26T04:35:23.028838+00:00 [queued]>
[2023-12-26T04:35:26.770+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: potential_customers_process.extract_customer manual__2023-12-26T04:35:23.028838+00:00 [queued]>
[2023-12-26T04:35:26.771+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2023-12-26T04:35:26.771+0000] {taskinstance.py:1363} INFO - Starting attempt 1 of 1
[2023-12-26T04:35:26.771+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2023-12-26T04:35:26.779+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): extract_customer> on 2023-12-26 04:35:23.028838+00:00
[2023-12-26T04:35:26.783+0000] {standard_task_runner.py:55} INFO - Started process 27613 to run task
[2023-12-26T04:35:26.786+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'potential_customers_process', 'extract_customer', 'manual__2023-12-26T04:35:23.028838+00:00', '--job-id', '91', '--raw', '--subdir', 'DAGS_FOLDER/potential_customers_process.py', '--cfg-path', '/tmp/tmp9t7l4c60']
[2023-12-26T04:35:26.788+0000] {standard_task_runner.py:83} INFO - Job 91: Subtask extract_customer
[2023-12-26T04:35:26.834+0000] {task_command.py:376} INFO - Running <TaskInstance: potential_customers_process.extract_customer manual__2023-12-26T04:35:23.028838+00:00 [running]> on host 2d20203c1be8
[2023-12-26T04:35:26.889+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=potential_customers_process
AIRFLOW_CTX_TASK_ID=extract_customer
AIRFLOW_CTX_EXECUTION_DATE=2023-12-26T04:35:23.028838+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-12-26T04:35:23.028838+00:00
[2023-12-26T04:35:26.890+0000] {logging_mixin.py:120} INFO - Files in the current directory:
[2023-12-26T04:35:26.891+0000] {logging_mixin.py:120} INFO - logs
[2023-12-26T04:35:26.892+0000] {logging_mixin.py:120} INFO - dags
[2023-12-26T04:35:26.892+0000] {logging_mixin.py:120} INFO - webserver_config.py
[2023-12-26T04:35:26.892+0000] {logging_mixin.py:120} INFO - ***-worker.pid
[2023-12-26T04:35:26.893+0000] {logging_mixin.py:120} INFO - plugins
[2023-12-26T04:35:26.893+0000] {logging_mixin.py:120} INFO - ***.cfg
[2023-12-26T04:35:26.911+0000] {logging_mixin.py:120} INFO - =====================
[2023-12-26T04:35:26.931+0000] {logging_mixin.py:120} INFO -    0 First Name  Last Name  Gender        Country  Age  Last login    Id
0  1      Dulce      Abril  Female  United States   32  15/10/2022  1562
1  2       Mara  Hashimoto  Female  Great Britain   25  16/08/2020  1582
2  3     Philip       Gent    Male         France   36  21/05/2023  2587
3  4   Kathleen     Hanner  Female  United States   25  15/10/2023  3549
4  5    Nereida    Magwood  Female  United States   58  16/08/2016  2468
5  6     Gaston      Brumm    Male  United States   24  21/05/2019  2554
6  7       Etta       Hurn  Female  Great Britain   56  15/10/2022  3598
7  8    Earlean     Melgar  Female  United States   27  16/08/2021  2456
8  9   Vincenza    Weiland  Female  United States   40  21/05/2021  6548
[2023-12-26T04:35:26.931+0000] {python.py:177} INFO - Done. Returned value was:    0 First Name  Last Name  Gender        Country  Age  Last login    Id
0  1      Dulce      Abril  Female  United States   32  15/10/2022  1562
1  2       Mara  Hashimoto  Female  Great Britain   25  16/08/2020  1582
2  3     Philip       Gent    Male         France   36  21/05/2023  2587
3  4   Kathleen     Hanner  Female  United States   25  15/10/2023  3549
4  5    Nereida    Magwood  Female  United States   58  16/08/2016  2468
5  6     Gaston      Brumm    Male  United States   24  21/05/2019  2554
6  7       Etta       Hurn  Female  Great Britain   56  15/10/2022  3598
7  8    Earlean     Melgar  Female  United States   27  16/08/2021  2456
8  9   Vincenza    Weiland  Female  United States   40  21/05/2021  6548
[2023-12-26T04:35:26.942+0000] {xcom.py:600} ERROR - Could not serialize the XCom value into JSON. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your *** config.
[2023-12-26T04:35:26.943+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 2385, in xcom_push
    session=session,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 212, in set
    map_index=map_index,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 597, in serialize_value
    return json.dumps(value).encode('UTF-8')
  File "/usr/local/lib/python3.7/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.7/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.7/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.7/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type DataFrame is not JSON serializable
[2023-12-26T04:35:26.962+0000] {taskinstance.py:1406} INFO - Marking task as FAILED. dag_id=potential_customers_process, task_id=extract_customer, execution_date=20231226T043523, start_date=20231226T043526, end_date=20231226T043526
[2023-12-26T04:35:26.979+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 91 for task extract_customer (Object of type DataFrame is not JSON serializable; 27613)
[2023-12-26T04:35:27.002+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2023-12-26T04:35:27.029+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
